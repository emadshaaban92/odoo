<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>
    <!-- Article Tree layout -->
    <template id="knowledge_article_tree_template" name="Article Tree">
        <section class="mb-3">
            <div class="h4 mb-1">Favourites</div>
            <ul t-if="favourites" class="o_tree_favourite m-0 px-0 py-2">
                <li t-if="favourite.user_has_access" t-foreach="favourites" t-as="favourite"
                    t-attf-class="#{ 'bg-light font-weight-bold' if favourite.id == active_article_id else '' }"
                    t-att-data-article-id="favourite.id">
                    <div class="d-flex">
                        <span t-esc="favourite.icon" class="o_article_icon px-1 py-0"/>
                        <div class="o_article_name flex-grow-1 text-truncate">
                            <t t-out="favourite.name"/>
                        </div>
                    </div>
                </li>
            </ul>
            <div t-else="" class="px-0 py-2 font-italic">
                No favourite yet
            </div>
        </section>

        <section class="mb-3">
            <div class="o_section_header d-flex h4 mb-1">
                <div class="o_section_name flex-grow-1 text-truncate">Workspace</div>
                <button class="o_section_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul t-if="len(public_articles) > 0" class="o_tree m-0 p-0" data-section="workspace">
                <t t-foreach="public_articles.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
            <ul t-else="" class="o_tree m-0 p-0" data-section="workspace"/>
            <!-- For the `:empty` css selector to be applied, the `ul` element shouldn't
                 contain any whitespace. Here, the `t-else` will ensure that the `ul`
                 element will be empty -->
        </section>

        <section class="mb-3">
            <div class="o_section_header d-flex h4 mb-1">
                <div class="o_section_name flex-grow-1 text-truncate">Shared</div>
                <button class="o_section_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul t-if="len(shared_articles) > 0" class="o_tree m-0 p-0" data-section="shared">
                <t t-foreach="shared_articles.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
            <ul t-else="" class="o_tree m-0 p-0" data-section="shared"/>
        </section>

        <section class="mb-3">
            <div class="o_section_header d-flex h4 mb-1">
                <div class="o_section_name flex-grow-1 text-truncate">Private</div>
                <button class="o_section_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul t-if="len(private_articles) > 0" class="o_tree m-0 p-0" data-section="private">
                <t t-foreach="private_articles.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
            <ul t-else="" class="o_tree m-0 p-0" data-section="private"/>
        </section>
    </template>

    <template id="article_template">
        <li t-attf-id="article_#{article.id}" t-att-data-article-id="article.id">
            <div t-attf-class="o_article d-flex #{ 'bg-light font-weight-bold rounded' if article.id == active_article_id else '' }">
                <button class="o_article_caret btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-caret-down align-self-center"/>
                </button>
                <div class="o_article_dropdown btn-group dropdown">
                    <button t-esc="article.icon"
                        t-attf-id="o_article_dropdown_#{article.id}"
                        class="o_article_icon btn btn-link text-secondary rounded px-1 py-0"
                        type="button"
                        data-toggle="dropdown"
                        aria-expanded="true" />
                        <div class="o_knowledge_emoji_panel dropdown-menu rounded bg-light p-0" role="menu"
                            t-attf-aria-labelledby="o_article_dropdown_#{article.id}"/>
                </div>
                <div class="o_article_name flex-grow-1 text-truncate px-1">
                    <t t-out="article.name"/>
                </div>
                <button class="o_article_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul t-if="article.child_ids">
                <t t-foreach="article.child_ids.sorted('sequence')" t-as="child">
                    <t t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
        </li>
    </template>
</data>
</odoo>
