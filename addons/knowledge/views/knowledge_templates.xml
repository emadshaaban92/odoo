<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>
    <!-- Article Tree layout -->
    <template id="knowledge_article_tree_template" name="Article Tree">
        <section t-if="favourites">
            <div class="h4 mb-0">Favourites</div>
            <ul class="o_tree_favourite m-0 px-0 py-2">
                <li t-foreach="favourites" t-as="favourite"
                    t-attf-class="#{ 'bg-light' if favourite.id == active_article_id else '' }"
                    t-att-data-article-id="favourite.id">
                    <div class="d-flex">
                        <span t-esc="favourite.icon" class="o_article_icon px-1 py-0"/>
                        <div t-attf-class="o_article_name flex-grow-1 text-truncate #{ 'font-weight-bold' if favourite.id == active_article_id else '' }">
                            <t t-out="favourite.name"/>
                        </div>
                    </div>
                </li>
            </ul>
        </section>

        <section class="o_section" data-section="workspace">
            <div class="o_section_header d-flex h4 mb-0">
                <div class="flex-grow-1 text-truncate">Workspace</div>
                <button class="o_section_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul class="o_tree m-0 px-0 py-2">
                <t t-foreach="public_articles.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
        </section>

        <section t-if="shared_articles" class="o_section mb-3" data-section="shared">
            <div class="o_section_header d-flex h4 mb-0">
                <div class="flex-grow-1 text-truncate">Shared</div>
            </div>
            <ul class="o_tree m-0 px-0 py-2">
                <t t-foreach="shared_articles.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
        </section>

        <section class="o_section mb-3" data-section="private">
            <div class="o_section_header d-flex h4 mb-0">
                <div class="flex-grow-1 text-truncate">Private</div>
                <button class="o_section_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul class="o_tree m-0 px-0 py-2">
                <t t-foreach="private_articles.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
        </section>
    </template>

    <template id="article_template">
        <li class="o_article" t-att-data-article-id="article.id">
            <div t-attf-class="o_article_handle d-flex #{ 'bg-light rounded' if article.id == active_article_id else '' }">
                <button class="o_article_caret btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-caret-down align-self-center"/>
                </button>
                <div class="o_article_dropdown btn-group dropdown">
                    <button class="o_article_icon btn btn-link text-secondary rounded px-1 py-0" type="button"
                        t-attf-id="o_article_dropdown_#{article.id}" data-toggle="dropdown" aria-expanded="true">
                        <t t-esc="article.icon"/>
                    </button>
                    <div class="o_knowledge_emoji_panel dropdown-menu rounded p-0" role="menu"
                        t-attf-aria-labelledby="o_article_dropdown_#{article.id}"/>
                </div>
                <div t-attf-class="o_article_name flex-grow-1 text-truncate px-1 #{ 'font-weight-bold' if article.id == active_article_id else '' }">
                    <t t-out="article.name"/>
                </div>
                <button class="o_article_create btn btn-link text-secondary rounded p-0" type="button">
                    <i class="fa fa-fw fa-plus"/>
                </button>
            </div>
            <ul t-if="article.child_ids">
                <t t-foreach="article.child_ids.sorted('sequence')" t-as="child">
                    <t t-if="child.user_has_access" t-call="knowledge.article_template">
                        <t t-set="article" t-value="child"/>
                    </t>
                </t>
            </ul>
        </li>
    </template>
</data>
</odoo>
