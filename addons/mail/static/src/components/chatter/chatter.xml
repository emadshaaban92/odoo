<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.Chatter" owl="1">
        <t t-if="chatter">
            <div class="o_Chatter position-relative flex-grow-1 flex-column d-flex w-100 bg-view" t-attf-class="{{ className }}" t-ref="root">
                <t t-if="chatter.dropZoneView">
                    <DropZoneView
                        className="'o_Chatter_dropZone'"
                        record="chatter.dropZoneView"
                    />
                </t>
                <div class="o_Chatter_fixedPanel">
                    <div t-if="chatter.hasTopBar" class="o_ChatterTopbar justify-content-between d-flex" t-attf-class="{{ className }}" >
                        <div class="o_ChatterTopbar_actions flex-fill d-flex border-transparent">
                            <div class="o_ChatterTopbar_controllers d-flex pe-2" t-if="chatter.threadView">
                                <button class="o_ChatterTopbar_button o_ChatterTopbar_buttonSendMessage btn text-nowrap me-2"
                                    type="button"
                                    t-att-class="{
                                        'o-active btn-odoo': chatter.composerView and !chatter.composerView.composer.isLog,
                                        'btn-odoo': !chatter.composerView,
                                        'btn-light': chatter.composerView and chatter.composerView.composer.isLog,
                                    }"
                                    t-att-disabled="!chatter.hasWriteAccess"
                                    data-hotkey="m"
                                    t-on-click="chatter.onClickSendMessage"
                                >
                                    Send message
                                </button>
                                <button class="o_ChatterTopbar_button o_ChatterTopbar_buttonLogNote btn text-nowrap"
                                    type="button"
                                    t-att-class="{
                                        'o-active btn-odoo': chatter.composerView and chatter.composerView.composer.isLog,
                                        'btn-light': chatter.composerView and !chatter.composerView.composer.isLog or !chatter.composerView,
                                    }"
                                    t-att-disabled="!chatter.hasWriteAccess"
                                    t-on-click="chatter.onClickLogNote"
                                    data-hotkey="shift+m"
                                >
                                    Log note
                                </button>
                            </div>
                            <div class="o_ChatterTopbar_tools position-relative d-flex flex-grow-1 border-bottom"
                                t-att-class="{
                                    'border-start ps-2': chatter.hasActivities,
                                }"
                            >
                                <t t-if="chatter.hasActivities">
                                    <button class="o_ChatterTopbar_button o_ChatterTopbar_buttonScheduleActivity btn btn-light text-nowrap" type="button" t-att-disabled="!chatter.hasWriteAccess" t-on-click="chatter.onClickScheduleActivity" data-hotkey="shift+a">
                                        <i class="fa fa-clock-o me-1"/>
                                        <span>Activities</span>
                                    </button>
                                </t>
                                <div class="flex-grow-1 border-start pe-2"
                                    t-att-class="{
                                        'ms-2': chatter.hasActivities,
                                    }"
                                />
                                <div class="o_ChatterTopbar_rightSection flex-grow-1 flex-shrink-0 justify-content-end d-flex">
                                    <button t-if="chatter.thread.allAttachments.length === 0" class="o_ChatterTopbar_button o_ChatterTopbar_buttonAddAttachments btn btn-light btn-primary" type="button" t-att-disabled="!chatter.hasWriteAccess" t-on-click="chatter.onClickButtonAddAttachments" >
                                        <i class="fa fa-paperclip fa-lg me-1" role="img" aria-label="Attachments"/>
                                        <t t-if="chatter.isShowingAttachmentsLoading">
                                            <i class="o_ChatterTopbar_buttonAttachmentsCountLoader fa fa-circle-o-notch fa-spin" aria-label="Attachment counter loading..."/>
                                        </t>
                                    </button>
                                    <button t-if="chatter.thread.allAttachments.length > 0" class="o_ChatterTopbar_button o_ChatterTopbar_buttonToggleAttachments btn btn-light btn-primary" type="button" t-att-disabled="!chatter.hasReadAccess" t-att-aria-expanded="chatter.attachmentBoxView ? 'true' : 'false'" t-on-click="chatter.onClickButtonToggleAttachments">
                                        <i class="fa fa-paperclip fa-lg me-1" role="img" aria-label="Attachments"/>
                                        <t t-if="!chatter.isShowingAttachmentsLoading">
                                            <span class="o_ChatterTopbar_buttonCount o_ChatterTopbar_buttonAttachmentsCount" t-esc="chatter.attachmentButtonText"/>
                                        </t>
                                        <t t-if="chatter.isShowingAttachmentsLoading">
                                            <i class="o_ChatterTopbar_buttonAttachmentsCountLoader fa fa-circle-o-notch fa-spin" aria-label="Attachment counter loading..."/>
                                        </t>
                                    </button>
                                    <t t-if="chatter.hasFollowers and chatter.thread">
                                        <FollowerListMenuView
                                            className="'o_ChatterTopbar_followerListMenu'"
                                            record="chatter.followerListMenuView"
                                        />
                                        <t t-if="chatter.followButtonView">
                                            <FollowButtonView
                                                className="'o_ChatterTopbar_followButton'"
                                                record="chatter.followButtonView"
                                            />
                                        </t>
                                    </t>
                                </div>
                            </div>
                        </div>
                        <t t-if="chatter.hasTopbarCloseButton">
                            <button class="o_ChatterTopbar_buttonClose btn btn-dark flex-shrink-0 rounded-bottom-3" aria-label="Close" t-on-click="chatter.onClickChatterTopbarClose">
                                <i class="oi oi-large oi-close"/>
                            </button>
                        </t>
                    </div>
                    <t t-if="chatter.composerView">
                        <ComposerView
                            className="'o_Chatter_composer border-bottom'"
                            classNameObj="{ 'o-bordered': chatter.hasExternalBorder }"
                            record="chatter.composerView"
                        />
                    </t>
                </div>
                <div class="o_Chatter_scrollPanel overflow-auto" t-on-scroll="chatter.onScrollScrollPanel" t-ref="scrollPanel">
                    <t t-if="chatter.attachmentBoxView">
                        <AttachmentBoxView
                            className="'o_Chatter_attachmentBox'"
                            record="chatter.attachmentBoxView"
                        />
                    </t>
                    <t t-if="chatter.activityBoxView">
                        <ActivityBoxView
                            className="'o_Chatter_activityBox'"
                            record="chatter.activityBoxView"
                        />
                    </t>
                    <t t-if="chatter.threadView">
                        <ThreadView
                            className="'o_Chatter_thread'"
                            record="chatter.threadView"
                        />
                    </t>
                </div>
            </div>
        </t>
    </t>

</templates>
