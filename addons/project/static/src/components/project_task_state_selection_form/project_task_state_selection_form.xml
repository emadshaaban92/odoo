<templates>
    <t t-name="project.ProjectTaskStateSelectionForm" owl="1">
        <div class="o_state_box flex-grow-1 flex-shrink-0 d-flex" 
                t-attf-class="{ #{!state.isStateBoxHighlighted ? 'add_left_pad' : ''}" 
                t-on-mouseenter="onMouseEnterStateBox" 
                t-on-mouseleave="onMouseLeaveStateBox">
            <ProjectTaskStateAutoDropdown t-if="state.isStateBoxHighlighted" togglerClass="'btn d-flex p-0'">
                <t t-set-slot="toggler">
                    <button class="o_switch_mode_button btn btn-light rounded-pill text-muted m-0" t-on-mouseenter="onMouseEnterModeSelection" t-on-mouseleave="onMouseLeaveModeSelection">
                        <i class="fa fa-fw fa-plus"/>
                    </button>
                    <!--
                        <button class="o_switch_mode_button btn btn-light rounded-pill text-muted m-0" t-on-mouseenter="onMouseEnterModeSelection" t-on-mouseleave="onMouseLeaveModeSelection">
                            <i class="fa fa-fw fa-plus"/>
                        </button>
                    </div>-->
                </t>
                <t t-foreach="switchModeAvailableOptions" t-as="option" t-key="option[0]">
                    <DropdownItem onSelected="() => props.update(option[0])">
                        <div class="d-flex align-items-center">
                            <span t-attf-class="fa-fw fa {{ stateIcon(option[0]) }} {{ stateColor(option[0]) }}"/>
                            <span t-attf-class="ms-2 {{ stateColor(option[0]) }}" t-esc="option[1]"/>
                        </div>
                    </DropdownItem>
                </t>
            </ProjectTaskStateAutoDropdown>
                

            <div class="o_state_display d-flex">
                <t t-if="!isApproval">
                    <button class="o_state_non_approval_button btn oe_highlight rounded-pill" 
                    t-attf-class="{ #{state.isStateButtonHighlighted ? 'oe_highlight text-success' : ''} 
                    #{this.props.value == 'done' ? 'btn-success' : 'btn-light border border-dark'} }"
                    t-on-click="onClickState" t-on-mouseenter="onMouseEnterStateButton" 
                    t-on-mouseleave="onMouseLeaveStateButton">
                            <span t-if="this.props.value == 'waiting'">
                                <i class="fa fa-fw fa-hourglass"/>
                            </span>
                            <span t-if="this.props.value == 'in_progress'">
                                <span t-if="!state.isStateButtonHighlighted">
                                    <t t-out="'In Progress'"></t>
                                </span>
                                <span t-else="" class="text-success">
                                    <i class="fa fa-fw fa-check"/>
                                    <t t-out="'Mark Done'"></t>
                                </span>
                            </span>
                            <span t-else="">
                                <i class="fa fa-fw fa-check"/>
                                Done
                            </span>
                    </button>
                </t>
                <t t-else="">
                    <Dropdown class="toggle_dropdown" togglerClass="'o_state_approval_dropdown btn d-flex p-0'">
                        <t t-set-slot="toggler">
                            <button class="o_state_approval_button btn rounded-pill d-flex " t-attf-class="{{ colorButton[currentValue] }}">
                                <!--
                                    <span t-attf-class="fa-fw fa {{ stateIcon(currentValue) }} {{ stateColor(currentValue) }}"/>
                                -->
                                <span class="o_status_label ms-1" t-esc="label"/>
                            </button>
                        </t>
                        <t t-foreach="availableOptions" t-as="option" t-key="option[0]">
                            <DropdownItem onSelected="() => props.update(option[0])">
                                <div class="d-flex align-items-center">
                                    <span t-attf-class="fa-fw fa {{ stateIcon(option[0]) }} {{ stateColor(option[0]) }}"/>
                                    <span t-attf-class="ms-2 {{ stateColor(option[0]) }}" t-esc="option[1]"/>
                                </div>
                            </DropdownItem>
                        </t>
                    </Dropdown>
                </t>
            </div>
        </div>
    </t>

</templates>
